<div class="mx-auto w-full max-w-md overflow-hidden rounded-sm bg-white shadow-lg">
  <div
    class="px-2 pt-3 pb-4 bg-no-repeat bg-cover bg-center"
    style="background-image: url('/assets/images/header-booking.png')"
  >
    <div class="flex items-center justify-center gap-2">
      <img src="/assets/images/nokair-logo.png" alt="Nok Air" class="h-7 w-auto" />
    </div>
    <div class="mt-3 py-4">
      <div class="relative mx-auto max-w-md">
        <div class="relative grid grid-cols-4 justify-items-center">
          <div
            class="absolute left-[12.5%] right-[12.5%] top-4 z-0 border-t border-dashed border-[#b18a00]"
          ></div>

          <div class="relative z-10 flex flex-col items-center gap-2">
            <div
              class="flex h-8 w-8 items-center justify-center rounded-full bg-[#4c4c4c] text-lg font-semibold text-white"
            >
              1
            </div>
            <span class="text-sm font-semibold text-[#303030]">กรอกข้อมูล</span>
          </div>

          <div class="relative z-10 flex flex-col items-center gap-2">
            <div
              class="flex h-8 w-8 items-center justify-center rounded-full border-2 border-[#b18a00] bg-[#FFCB08] text-lg font-semibold text-[#b18a00]"
            >
              2
            </div>
            <span class="text-sm font-semibold text-[#b18a00]">เลือกที่นั่ง</span>
          </div>

          <div class="relative z-10 flex flex-col items-center gap-2">
            <div
              class="flex h-8 w-8 items-center justify-center rounded-full border-2 border-[#b18a00] bg-[#FFCB08] text-lg font-semibold text-[#b18a00]"
            >
              3
            </div>
            <span class="text-sm font-semibold text-[#b18a00]">ตรวจสอบข้อมูล</span>
          </div>

          <div class="relative z-10 flex flex-col items-center gap-2">
            <div
              class="flex h-8 w-8 items-center justify-center rounded-full border-2 border-[#b18a00] bg-[#FFCB08] text-lg font-semibold text-[#b18a00]"
            >
              4
            </div>
            <span class="text-sm font-semibold text-[#b18a00]">ยืนยันชำระเงิน</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex gap-2 overflow-x-auto no-scrollbar border-b border-[#ededed] bg-white px-3 py-3">
    @for (tab of passengerTabs; track tab; let idx = $index) {
      <button
        type="button"
        class="min-w-[110px] rounded border px-3 py-2 text-sm"
        [ngClass]="
          idx + 1 === currentPassenger
            ? 'border-[#ffd400] bg-[#fff7cf] text-[#1f1f1f]'
            : 'border-[#dcdcdc] bg-white text-[#a7a7a7]'
        "
      >
        {{ tab }}
      </button>
    }
  </div>

  <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()" class="px-4 py-4">
    <h2 class="font-bold">Passenger 1 (Primary passenger)</h2>
    <h3 class="font-medium">General Information</h3>

    <div class="mt-4 space-y-2">
      <hlm-form-field>
        <brn-select class="inline-block w-full" placeholder="Title *" formControlName="title">
          <hlm-select-trigger class="w-full">
            <hlm-select-value />
          </hlm-select-trigger>

          <hlm-select-content>
            <hlm-select-label>Title</hlm-select-label>
            @for (option of titleOptions; track option) {
              <hlm-option [value]="option">{{ option }}</hlm-option>
            }
          </hlm-select-content>
        </brn-select>
        @if (isInvalid('title')) {
          <hlm-error>Title is required.</hlm-error>
        }
      </hlm-form-field>

      <hlm-form-field>
        <input
          id="firstName"
          hlmInput
          formControlName="firstName"
          placeholder="First Name (English) *"
        />
        @if (isInvalid('firstName')) {
          <hlm-error>First name is required and must be English letters only.</hlm-error>
        }
      </hlm-form-field>

      <!-- Middle Name -->
      <hlm-form-field>
        <input
          id="middleName"
          hlmInput
          formControlName="middleName"
          placeholder="Middle Name (English)"
        />
        @if (isInvalid('middleName')) {
          <hlm-error>Middle name must be English letters only.</hlm-error>
        }
      </hlm-form-field>

      <!-- Last Name -->
      <hlm-form-field>
        <input
          id="lastName"
          hlmInput
          formControlName="lastName"
          placeholder="Last Name (English) *"
        />
        @if (isInvalid('lastName')) {
          <hlm-error>Last name is required and must be English letters only.</hlm-error>
        }
      </hlm-form-field>

      <!-- Date of Birth -->
      <hlm-form-field>
        <input id="dateOfBirth" hlmInput type="date" formControlName="dateOfBirth" />
        @if (isInvalid('dateOfBirth')) {
          <hlm-error>Date of birth is required.</hlm-error>
        }
      </hlm-form-field>
    </div>

    <h3 class="mt-4 font-medium">Passport Information</h3>

    <div class="mt-4 space-y-2">
      <div class="grid grid-cols-2 gap-3">
        <!-- Nationality (select -> brn-select) -->
        <hlm-form-field>
          <brn-select
            class="inline-block w-full"
            placeholder="Nationality *"
            formControlName="nationality"
          >
            <hlm-select-trigger class="w-full">
              <hlm-select-value />
            </hlm-select-trigger>

            <hlm-select-content>
              <hlm-select-label>Nationality</hlm-select-label>
              @for (nationality of nationalities; track nationality) {
                <hlm-option [value]="nationality">{{ nationality }}</hlm-option>
              }
            </hlm-select-content>
          </brn-select>

          @if (isInvalid('nationality')) {
            <hlm-error>Nationality is required.</hlm-error>
          }
        </hlm-form-field>

        <!-- Country of residence (select -> brn-select) -->
        <hlm-form-field>
          <brn-select
            class="inline-block w-full"
            placeholder="Country of residence *"
            formControlName="countryOfResidence"
          >
            <hlm-select-trigger class="w-full">
              <hlm-select-value />
            </hlm-select-trigger>

            <hlm-select-content>
              <hlm-select-label>Country of residence</hlm-select-label>
              @for (country of countries; track country) {
                <hlm-option [value]="country">{{ country }}</hlm-option>
              }
            </hlm-select-content>
          </brn-select>

          @if (isInvalid('countryOfResidence')) {
            <hlm-error>Country of residence is required.</hlm-error>
          }
        </hlm-form-field>
      </div>

      <!-- Passport Number -->
      <hlm-form-field>
        <input
          id="passportNumber"
          hlmInput
          formControlName="passportNumber"
          placeholder="Passport Number *"
        />
        @if (isInvalid('passportNumber')) {
          <hlm-error>Passport number is required (6–12 A–Z / 0–9).</hlm-error>
        }
      </hlm-form-field>

      <!-- Issued By (select -> brn-select) -->
      <hlm-form-field>
        <brn-select
          class="inline-block w-full"
          placeholder="Issued By *"
          formControlName="issuedBy"
        >
          <hlm-select-trigger class="w-full">
            <hlm-select-value />
          </hlm-select-trigger>

          <hlm-select-content>
            <hlm-select-label>Issued By</hlm-select-label>
            @for (country of countries; track country) {
              <hlm-option [value]="country">{{ country }}</hlm-option>
            }
          </hlm-select-content>
        </brn-select>

        @if (isInvalid('issuedBy')) {
          <hlm-error>Issued by is required.</hlm-error>
        }
      </hlm-form-field>

      <!-- Passport Expiry Date -->
      <hlm-form-field>
        <input id="passportExpiryDate" hlmInput type="date" formControlName="passportExpiryDate" />
        @if (isInvalid('passportExpiryDate')) {
          <hlm-error>Passport expiry date is required.</hlm-error>
        }
      </hlm-form-field>
    </div>

    <h3 class="mt-4 font-medium">Contact Information</h3>

    <div class="mt-4 space-y-2">
      <div class="grid grid-cols-[120px_1fr] gap-3">
        <!-- Mobile Country Code (select -> brn-select) -->
        <hlm-form-field>
          <brn-select
            class="inline-block w-full"
            placeholder="Code *"
            formControlName="mobileCountryCode"
          >
            <hlm-select-trigger class="w-full">
              <hlm-select-value />
            </hlm-select-trigger>

            <hlm-select-content>
              <hlm-select-label>Code</hlm-select-label>
              @for (code of mobileCountryCodes; track code) {
                <hlm-option [value]="code">{{ code }}</hlm-option>
              }
            </hlm-select-content>
          </brn-select>

          @if (isInvalid('mobileCountryCode')) {
            <hlm-error>Mobile code is required.</hlm-error>
          }
        </hlm-form-field>

        <!-- Mobile Number -->
        <hlm-form-field>
          <input
            id="mobileNumber"
            hlmInput
            formControlName="mobileNumber"
            placeholder="Mobile Number *"
          />
          @if (isInvalid('mobileNumber')) {
            <hlm-error>Mobile number is required (8–15 digits).</hlm-error>
          }
        </hlm-form-field>
      </div>

      <!-- Email -->
      <hlm-form-field>
        <input id="email" hlmInput formControlName="email" placeholder="Email *" />
        @if (isInvalid('email')) {
          <hlm-error>The email is required and must be valid.</hlm-error>
        }
      </hlm-form-field>
    </div>

    <div class="mt-2 space-y-2 pb-2">
      <button
        type="submit"
        hlmBtn
        class="w-full !bg-transparent !border-0 !shadow-none !px-0 py-2 text-sm font-semibold text-[#1c1c1c] flex items-center justify-center gap-2"
      >
        <span class="underline decoration-2 underline-offset-4">Continue to Next Passenger</span>
        <ng-icon name="lucideArrowRight" class="flex-none" size="18" aria-hidden="true"></ng-icon>
      </button>

      <button
        type="button"
        hlmBtn
        variant="secondary"
        class="w-full rounded-[4px] bg-[#d4d4d4] py-3 text-sm font-semibold text-[#666]"
        [disabled]="bookingForm.invalid"
      >
        Confirm
      </button>
    </div>
  </form>
</div>
